<%= bootstrap_devise_error_messages! %>

<h1><%= t('.sign_up', default: 'Sign up') %></h1>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { role: 'form' }) do |f| %>
  <div class="form-group">
    <%= f.label :username %>
    <%= f.text_field :username, autofocus: true, class: 'form-control', required: true %>
  </div>
  <div class="form-group">
    <%= f.label :email %>
    <%= f.email_field :email, class: 'form-control', required: true %>
  </div>
  <div class="form-group">
    <%= f.label :password %>
    <%= f.password_field :password, class: 'form-control', required: true, minlength: 8 %>
  </div>
  <div class="form-group">
    <%= f.label :password_confirmation %>
    <%= f.password_field :password_confirmation, class: 'form-control', required: true, minlength: 8 %>
  </div>
  <div class="form-group">
    <label class="custom-control custom-checkbox">
      <%= f.check_box :terms_of_service, class: 'custom-control-input', required: true %>
      <span class="custom-control-indicator"></span>
      <span class="custom-control-description">
        I accept the <%= link_to 'terms of service', policies_terms_path %>.
      </span>
    </label>
  </div>

  <div class="form-group">
    <%= f.submit t('.sign_up', default: 'Sign up'), class: 'btn btn-primary' %>
  </div>
<% end %>

<%= render 'devise/shared/links' %>

<script>
  var password, password_confirmation, validatePassword;

  password = document.getElementById('user_password');

  password_confirmation = document.getElementById('user_password_confirmation');

  validatePassword = function() {
    if (password.value !== password_confirmation.value) {
      password_confirmation.setCustomValidity("Please make sure your passwords match.");
    } else {
      password_confirmation.setCustomValidity('');
    }
  };

  password.onchange = validatePassword;

  password_confirmation.onkeyup = validatePassword;
</script>
